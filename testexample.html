<!DOCTYPE html>
<html>
<head>

  <title>aa</title>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  
  <script src="http://popcornjs.org/code/dist/popcorn-complete.js"></script>
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.createjs.com/easeljs-0.6.1.min.js"></script>
  <script src="http://localhost:8888/socket.io/socket.io.js"></script>


  <link rel="stylesheet" type="text/css" href="basiccss.css">
  <script type="text/javascript">

  // var socket = io.connect('http://localhost:8888');
  var socket;
  jQuery(function() {
    socket = io.connect("http://localhost:8888/");

    socket.on('connect', function() {
      socket.on('return', function(data) {
        console.log(data);
      });

      socket.emit('sample', {hello: 'worldworld'});
    });
  });
  // socket.on('connect', function (data) {
  //   console.log(data);
  //   socket.emit('my other event', { my: 'data' });
  //   socket.on('return', function(data) {console.log(data)})
  // });


    var popcornobject; // global access video object 

    var canvaslayer; // canvas overlay

    var container;
    var stage;

    document.addEventListener( "DOMContentLoaded", function() {
      popcornobject = Popcorn("#ourvideo"); // 팝콘 객체 생성
      popcornobject.on("play", function() {

        console.log("Playing!");
        popcornobject.on("timeupdate", function(){
          console.log(popcornobject.currentTime());
          socket.emit('sample',{hello: popcornobject.currentTime()});
        })
      });

      $canvaslayer = document.getElementById("canvas1");
      stage = new createjs.Stage($canvaslayer);


      var content = new createjs.DOMElement("testdiv");
      content.regX = 154;
      content.regY = 100;
      // content.style.color = red;

      container = new createjs.Container();
      // $container.addChild("content");
      

      
      console.log($("#textinput1").val());
      //socket io 부분 테스팅 

      
      stage.onMouseDown = displayInputPanel; // on mouse click - input event occur. onClick won't work
      // alert(stage.mouseY);
      // stage.update();
      // alert(stage.mouseY);
      // stage.update();
    });


function displayInputPanel(evt){

  alert("in display");
  

  var textInputField = new createjs.DOMElement("textinput1");
  var textInputButton = new createjs.DOMElement("textbutton1");
  console.log(textInputField);

  textInputField.regX = -100;
  textInputField.regY = 0;

  textInputField.x = stage.mouseX;
  alert(textInputField.x + " " + stage.mouseX);
  textInputField.y = stage.mouseY;
  textInputButton.regX = -300; 
  textInputButton.regY = 0; 
  textInputButton.x = stage.mouseX;
  textInputButton.y = stage.mouseY;

  var frame = new createjs.Shape();
  frame.graphics.beginFill("#00F").drawRect(stage.mouseX,stage.mouseY,28,28);
  

  
      // container.addChild(textInputField, submitbutton1, frame);
      stage.addChild(textInputField);
      stage.addChild(textInputButton);
      stage.addChild(frame);
      // stage.addChild($container);
      stage.update();
    }

    function savetext()
    {
      alert("savetext");
    }

    
    </script>
    
  </head>
  <body>
    <div>
      <video id="ourvideo" controls="false">
        <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.mp4"/>
        <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.ogv"/>
        <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.webm"/>
      </video>
      <div id="canvascontainer">
        <canvas id="canvas1" width = "640px" height = "430px"></canvas>
        <canvas id="canvas2"></canvas>
      </div>

    </div>

    
    

    <div id="testdiv">
      <p>div tesing </p>
    </div>

    
    <input id="textinput1" name="nowfeel" type = "text" value="지금 당신의 생각을 남기세요" />
    <input id="textbutton1" type = "submit" value= "now"/> 
    
    

  </body>
  </html>